dist: xenial
language: python
matrix:
  include:
    - python: '3.6'
      env: EXTRA_PACKAGES='dataclasses'
    - python: '3.7'
install:
  - pip install janus $EXTRA_PACKAGES
  - pip install -r requirements-dev.txt
script:
  - pytest tests --cov=aioevents
cache:
  - apt
  - directories:
    - "$HOME/.cache/pip"
before_cache:
  - rm -f $HOME/.cache/pip/log/debug.log
after_success: codecov
deploy:
  provider: pypi
  user: mpyatishev
  password:
    secure: HO+vo0rGwZ0dDeuEb4IbFI8RZ3890I93+wys5UMYFwmPa/7uBnozoiiCgZwaUoSA/bpAWC5MDc6bohfOF4UoiFp3UaNfWGS7NJHuwt1P6bVeFhWHdJe3tAtk3d4sY6LxX3SK9enklC+pbOITr+MnmgbyvIMl2FUGSR0REe6UHH2xA9I804iAJimIaa7I/zDkYvoCKBTYeu3HbjQgBOKagOk70HIyW4OimNcF/2eV+hPadfee1hn4+ULuIkGZt+Tqz6oUXmf/Uo5Wn7mRAlAxS7Q7O8qIbPFyzFHn0CURU/byBOooseufK3npVE//yxAescqqQv2FUnNsW559fChRyJtNuazTZeSMEkRuPgu4nekKzmPYAqNwyi27PFKQevhISER7ZQ5nifHa2WdgyX/yCc0kECwYLhfw5Cu5kZ10q/Ajflxpp66/0NdxblxX6ue3AjmKlTJ9BzutOOT8cYpi/0WxpLl4cqT1Oiw2IyN/kzHYoB+ZwKBOqGd1fbNNzcTrvb/LEe7Gu0ZI6VKOD9R16xmccudjUQ061y/TW9rACQjgO2Rvy0yLA0128PgN0hS+s3e4H2/pEHX4iklJUhfcf6aDAS0tjw3htur6Do3xTVwokUa5v5wPTAgJi9CsLOxLgy+zi3Hh1ef9lUHvlhB3R3w2sx5jZFflYVMAiQVGvyI=
  distributions: sdist bdist_wheel
  skip_existing: true
  on:
    # tags: true
    all_branches: true
    python: 3.7
